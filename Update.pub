NBW Publication Source File
(C)1993-2013 NeoSoft Corp.
Title=Updater
Author=Sagleft
Language=US
NeoBookVer=5,80
ScreenColors=16777216
ScreenWidth=640
ScreenHeight=480
BkndColor=0
ScreenAutoSize=Yes
LinkColor=16711680
WindowStyle=0
WindowOrder=0
WindowPos=0
WindowProps=28
BiDiMode=0
AllowESC=No
AllowPageUpDn=No
UseUpdateTimer=Yes
ShowErrors=No
ReturnTime=60
StartupAction=SetVar "[name]" "mfc"
SubroutineAction=:format_size¶SetVar "[stIndex]" "1"¶ListBoxSize "ListBox6" "[stMax]"¶WhileEx "[stIndex]<[stMax] and [summ]>1024"¶    Math "[summ]/1000" "-1" "[summ]"¶    SetVar "[stIndex]" "[stIndex]+1"¶endwhile¶ListBoxGetItem "ListBox6" "[stIndex]" "[litera]"¶Math "[summ]" "2" "[summ]"¶return
ShapeTransColor=536870912
Icon=D:\Projects\MFCoin\tools\res\coreIcon.ico
SplashProps=3
CompressPub=Yes
CompiledName=D:\Projects\MFCoin\tools\build\Update.exe
CompileType=0
MediaType=0
FilesIncluded=1
FontsIncluded=2
FontsToCompile=|
CopyExternalFiles=No
SetupMedia=3
SetupInstDir=C:\MyProgram
SetupTitle=Setup
SetupColors=16711680|0|65535
Variables=[#10]¶[#13]¶[delete]¶[DeleteLen]¶[ext]¶[files]¶[FilesToLoad]¶[FolderNumber]¶[FolderPath]¶[folders]¶[hash]¶[item]¶[len]¶[ListBox3]¶[ListBox4]¶[loads]¶[loop]¶[looq]¶[menu]¶[name]¶[null]¶[pos]¶[result]¶[search]¶[server]¶[ServerHash]¶[ServerItem]¶[ServerSize]¶[size]¶[string1]¶[summ]¶[temp]¶[tmp]¶[tmps]¶
VersionProduct=Updater
VersionDesc=to Update version
VersionCompany=Argentum Sulife
VersionCopyright=by Sagleft
VersionMajor=1
VersionMinor=0
VersionRelease=0
VersionBuild=15
VersionAutoInc=Yes
ReqExLevel=3
AlertBoxImage=D:\Projects\MFCoin\tools\res\info.png
MsgBoxImage=D:\Projects\MFCoin\tools\res\message.png
ExitBoxImage=D:\Projects\MFCoin\tools\res\params.png
CustomFontName=Verdana
CustomFontSize=12
CustomFontStyle=0
CustomCharset=204
CacheSize=30
ExtractOp=132
L_OK=OK
L_CANCEL=Cancel
L_YES=Yes
L_NO=No
L_CLOSE=Close
L_ERRORTITLE=Error
L_FINDTITLE=Find
L_FINDPROMPT=Find &What
L_FINDFIRST=&Find First
L_FINDNEXT=Find &Next
L_FINDERROR=Search text not found.
L_PWORDTITLE=Password required
L_PWORDMSG=Before continuing, you must first|enter the correct password.
L_PWORDPROMPT=&Password:
L_PWORDERROR=That's not the right password!
L_MEDIAERROR=In order to play this type of file you must install|the appropriate multimedia hardware and/or|software.
L_INTERNETERROR=Unable to locate Internet Browser software.
L_ABORTFUNCTION=Do you want to cancel this function?
L_EXTRACTERROR=This file could not be extracted and cannot be played.
L_INSTDIRPROMPT=Please enter the drive and directory where you would like this program to be installed. To accept the default drive and directory, simply press Enter.
L_INSTFOLDERPROMPT=Do you wish to create a program folder?
L_INSTRUNPROMPT=Do you want to run
L_INSTDISKPROMPT=Please insert disk #
L_INSTDISKERROR=That's not the correct disk, try again.
L_INSTGENERROR=The installation has terminated.
L_INSTEXITPROMPT=Do you really want to cancel the installation?
L_INSTWINTITLE=Setup
L_INSTPROGTITLE=Extracting Files...
L_SENDEMAIL=Sending Mail...
L_MAILSERVER=Please enter the name of your outgoing email server:
L_COPY=Copy to Clipboard
L_SELECTALL=Select All
L_DONWLOADFILE=Downloading: %s
L_PLEASEWAIT=Please wait...
TrayMenuBegin
MenuName=TrayOpen
MenuText=Open
MenuState=3
MenuKey=0
MenuAction=SetVar "[WindowState]" "Normal"
MenuName=TrayExit
MenuText=Exit
MenuState=3
MenuKey=0
MenuAction=Exit "" ""
MenuEnd
MasterPage
NewPage=New Page
PageStyle=2
PageColor=16777215
PageGradient1=16711680
PageGradient2=255
PageGradientDir=1
PageWallPaper=D:\Projects\MFCoin\tools\res\updater_window.jpg
WallpaperStyle=1
EffectSpeed=0
ObjectType=3
Name=PushButton2
X=260
Y=170
W=330
H=40
Anchor=0
Text=Обновить карту файлов
Hint=Действие для разработчиков
Align=2
ImageStyle=0
ObjAction=FileExists "[pubdir]ConstrMap.exe" "[ext]"¶IfEx "[ext]=true"¶     .DisableObject "PushButton2"¶     HideObject "PushButton2" "None" "0"¶     Run "[pubdir]ConstrMap.exe" "" "Wait" "" ""¶     FileLen "[pubdir]files.txt" "[len]"¶     FileRead "[pubdir]files.txt" "[len]" "[temp]"¶     IfEx "[temp]=[null]"¶          FileDelLine "[pubdir]files.txt" "[len]"¶     endif¶     FileRead "[pubdir]files.txt" "All" "[temp]"¶     SetObjectCaption "ListBox3" "[temp]"¶     setvar "[temp]" ""¶     ListBoxSize "delete" "[DeleteLen]"¶     IfEx "[DeleteLen]>0"¶          Loop "1" "[DeleteLen]" "[loop]"¶               ListBoxGetItem "delete" "[loop]" "[item]"¶               ListBoxFindItem "ListBox3" "[item]" "[pos]"¶               IfEx "[pos]>0"¶                    ListBoxDeleteItem "ListBox3" "[pos]"¶               endif¶          endloop¶     endif¶     ListBoxSize "ListBox3" "[len]"¶     hpwIniWrite "[pubdir]FilesMap.ini" "Map" "files" "[len]"¶     Loop "1" "[len]" "[loop]"¶          ListBoxGetItem "ListBox3" "[loop]" "[item]"¶          NeoFileHashing "[pubdir][item]" "[hash]" "0"¶          FileSize "[pubdir][item]" "[size]"¶          ¶          hpwIniWrite "[pubdir]FilesMap.ini" "Map" "file[loop]" "[item]"¶          hpwIniWrite "[pubdir]FilesMap.ini" "Map" "file[loop]_size" "[size]"¶          hpwIniWrite "[pubdir]FilesMap.ini" "Map" "file[loop]_hash" "[hash]"¶     endloop¶     ShowObject "PushButton2" "None" "0"¶else¶     AlertBox "Уведомление" "Отсутствует ConstrMap.exe в папке с программой.||Верните файл на место или скомпилируйте свою|аналогичную программу с таким именем."¶endif
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Font=Verdana
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
Visible=No
TabOrder=1
ObjectType=10
Name=ListBox3
X=-230
Y=-220
W=230
H=180
Anchor=0
VarName=[ListBox3]
VarType=0
LineColor=0
LineWidth=1
LineStyle=0
FillColor=12632256
FillPattern=0
Font=Arial
FontSize=10
FontStyle=0
FontCharset=1
TextColor=0
TabOrder=2
ObjectType=10
Name=delete
X=10
Y=-220
W=200
H=180
Anchor=0
Text=files.txt¶Update.ini¶Updater.ico¶Server.png¶Update.bak¶Update.pub¶ConstrMap.exe¶FilesMap.ini¶Update_Test.exe¶Update.exe¶logo.png¶config.ini¶wallets.ini
VarName=[delete]
VarType=0
LineColor=0
LineWidth=1
LineStyle=0
FillColor=12632256
FillPattern=0
Font=Arial
FontSize=10
FontStyle=0
FontCharset=1
TextColor=0
TabOrder=3
ObjectType=3
Name=PushButton3
X=260
Y=220
W=330
H=40
Anchor=0
Text=Выполнить проверку обновлений
Align=2
ImageStyle=0
BevelWidth=1
ObjAction=SetVar "[string1]" "Сервер 1"¶SetVar "[server]" "sagleft.ru"¶¶SetVar "[summ]" "0"¶SetObjectCaption "FilesToLoad" ""¶¶DownloadFile "http://[server]/projects/[name]/FilesMap.ini" "[pubdir]Update.ini" "HideProgress"¶hpwIniRead "[pubdir]Update.ini" "Map" "files" "error" "[files]"¶IfEx "[files]=error"¶     AlertBox "Уведомление" "Произошла ошибка.||Варианты причины:|1. Выбранный сервер недоступен|2. У вас нет рабочего подключения к сети|3. У вас нет доступа к записи файлов|4. Произошло что-то невообразимое"¶else¶     DisableObject "PushButton3"¶     Loop "1" "[files]" "[loop]"¶          hpwIniRead "[pubdir]Update.ini" "Map" "file[loop]" "error" "[ServerItem]"¶          hpwIniRead "[pubdir]Update.ini" "Map" "file[loop]_size" "error" "[ServerSize]"¶          hpwIniRead "[pubdir]Update.ini" "Map" "file[loop]_hash" "error" "[ServerHash]"¶          ¶          SearchStr "\" "[ServerItem]" "[search]" ""¶          IfEx "[search]>0"¶              StrReplace "[ServerItem]" "\" "[#13][#10]" "[tmp]" ""¶              SetObjectCaption "ListBox4" "[tmp]"¶              ListBoxSize "ListBox4" "[folders]"¶              setvar "[folders]" "[folders]-1"¶              Loop "1" "[folders]" "[FolderNumber]"¶                   SetVar "[FolderPath]" ""¶                   Loop "1" "[FolderNumber]" "[looq]"¶                        ListBoxGetItem "ListBox4" "[looq]" "[tmps]"¶                        SetVar "[FolderPath]" "[FolderPath]\[tmps]"¶                   endloop¶                   StrDel "[FolderPath]" "1" "1" "[FolderPath]"¶                   FolderExists "[pubdir][FolderPath]" "[result]"¶                   IfEx "[result]=false"¶                        CreateFolder "[pubdir][FolderPath]"¶                   endif¶              endloop¶          endif¶          ¶          FileExists "[pubdir][ServerItem]" "[ext]"¶          IfEx "[ext]=false"¶               ListBoxAddItem "FilesToLoad" "0" "[ServerItem]"¶               SetVar "[summ]" "[summ]+[ServerSize]"¶          else¶               NeoFileHashing "[pubdir][ServerItem]" "[hash]" "0"¶               IfEx "[hash]=[ServerHash]"¶               else¶                   ListBoxAddItem "FilesToLoad" "0" "[ServerItem]"¶                   SetVar "[summ]" "[summ]+[ServerSize]"¶               endif¶          endif¶     endloop¶     ¶     IfEx "[summ]=0"¶          AlertBox "Уведомление" "Все файлы не|нуждаются в|обновлении"¶     else¶          GoSub "format_size"¶          MessageBox "Уведомление" "Обнаружены файлы, которые не|соответствуют файлам с сервера.||Два варианта:|1. Ваши файлы устарели|2. Файлы сервера устарели||Размер загружаемого обновления:|[summ] [litera]||Произвести замену ваших файлов|на файлы сервера?" "Да|Отмена" "[menu]"¶          IfEx "[menu]=1"¶               ListBoxSize "FilesToLoad" "[loads]"¶               Loop "1" "[loads]" "[loop]"¶                    ListBoxGetItem "FilesToLoad" "[loop]" "[item]"¶                    DownloadFile "http://[server]/projects/[name]/[item]" "[pubdir][item]" ""¶               endloop¶               AlertBox "Уведомление" "Обновление завершено"¶          endif¶          EnableObject "PushButton3"¶     endif¶     ¶     EnableObject "PushButton3"¶endif
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Font=Verdana
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
TabOrder=4
ObjectType=3
Name=PushButton4
X=260
Y=270
W=330
H=40
Anchor=0
Text=Закрыть приложение
Align=2
ImageStyle=0
BevelWidth=1
ObjAction=exit "" ""
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Font=Verdana
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
TabOrder=5
ObjectType=8
Name=Text3
X=0
Y=450
W=640
H=30
Anchor=0
Font=Verdana
FontSize=11
FontStyle=0
FontCharset=204
TextColor=8026746
Text={\rtf1\ansi\deff0\deftab254{\fonttbl{\f0\fnil\fcharset204 Verdana;}}{\pard{\qc\li0\fi0\ri0\sb0\sl\sa0 \plain\f0\fs22\cf0 UpdaterConstructor by Sagleft, 2018}}}
HMargin=0
VMargin=4
ObjAction=InternetLink "http://vk.com/sagleft"
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
TabOrder=6
ObjectType=10
Name=FilesToLoad
X=220
Y=-220
W=190
H=180
Anchor=0
VarName=[FilesToLoad]
VarType=0
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Font=Merriweather
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
TabOrder=7
ObjectType=10
Name=ListBox4
X=420
Y=-220
W=180
H=180
Anchor=0
VarName=[ListBox4]
VarType=0
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Font=Merriweather
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
TabOrder=8
ObjectType=3
Name=PushButton5
X=-20
Y=-20
W=20
H=20
Anchor=0
Align=2
Key=24699
ImageStyle=0
ObjAction=ShowObject "PushButton2" "None" "0"
LineColor=14671839
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Font=Merriweather
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
TabOrder=9
ObjectType=8
Name=Text4
X=10
Y=350
W=620
H=90
Anchor=0
Font=Verdana
FontSize=12
FontStyle=0
FontCharset=204
TextColor=0
Text={\rtf1\ansi\deff0\deftab254{\fonttbl{\f0\fnil\fcharset204 Merriweather;}{\f1\fnil\fcharset204 Verdana;}}{\pard{\qc\li0\fi0\ri0\sb0\sl\sa0 \plain\f1\fs24\cf0 [LastError]}}¶}
HMargin=0
VMargin=2
LineColor=14671839
LineWidth=0
LineStyle=0
FillColor=16777215
FillPattern=1
TabOrder=11
ObjectType=7
Name=Line1
X1=-659
Y1=131
X2=-61
Y2=131
EndCaps=0
LineColor=16777215
LineWidth=1
LineStyle=0
FillColor=16777215
FillPattern=0
Visible=No
TabOrder=10
ObjectType=10
Name=ListBox6
X=-220
Y=-20
W=180
H=150
Anchor=0
Text=байт¶кб¶мб¶гб¶тб¶пб
VarName=[ListBox6]
VarType=0
LineColor=0
LineWidth=0
LineStyle=0
FillColor=16777215
FillPattern=1
Font=Verdana
FontSize=14
FontStyle=0
FontCharset=204
TextColor=4868682
TabOrder=13
